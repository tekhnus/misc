#!/usr/bin/env bash

mkdir -p darwin || exit
go build -o darwin ./... || exit
rm ~/.local/bin/crsh*
cp darwin/* ~/.local/bin || exit

kitty @ launch \
  --type os-window \
  --title CRSH-SERVER \
  --cwd current \
  --hold \
  --env "PATH=$PATH" \
  crsh-server manager tcp://localhost:5678
kitty @ goto-layout \
  --match title:CRSH-SERVER \
  splits
kitty @ launch \
  --title CRSH-CLIENT \
  --match title:CRSH-SERVER \
  --location hsplit \
  --cwd current \
  --hold \
  crsh tcp://localhost:5678
kitty @ resize-window \
  --match title:CRSH-SERVER \
  --axis vertical \
  --increment +1000