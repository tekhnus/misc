#!/bin/sh
go build -o crsh-server cmd/server/main.go
go build -o crsh-client cmd/client/main.go

chan=/tmp/crsh.sock

dir=$(CDPATH= cd -- "$(dirname -- "$0")" && pwd)
winid=$(kitty @ launch --title crsh-server --location=before --cwd=${dir} bash -c "./crsh-server $chan $@")
kitty @ resize-window --self -a vertical -i -1000 2>/dev/null

sleep 1

./crsh-client "$chan" "$@"